<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script type="module">
        import './static/polyscript/index.js';

        const mpy = document.querySelector('script[type="mpy"]');
        if (mpy) {
            const mjs = new URL('./static/micropython.mjs', location)
            mpy.setAttribute('version', mjs);
            mpy.type = 'micropython';
        }
    </script>
</head>
<body>
<h1>Test running MicroPython code</h1>
<div>
    <button onclick="window.runExample()">Run</button>
</div>
<div id="output"></div>
<script type="module">
    const {loadMicroPython} = await import('./static/micropython.mjs');
    window.runExample = async function () {
        let stdout;
        let stderr;

        const mp = await loadMicroPython({
            stdout: (text) => stdout = text,
            stderr: (text) => stderr = text
        });
        mp.runPython("print(3+3)");
        console.log("Result:", stdout);
    }
</script>
<script type="mpy" config="./config.toml">
    from js import window
    window.runExample()
</script>

</body>
</html>